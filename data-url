data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sPgogIDxoZWFkPgogICAgPHRpdGxlPnJ0b3A8L3RpdGxlPgogICAgPG1ldGEgY2hhcnNldD0idXRmLTgiIC8+CiAgICA8c3R5bGU+aHRtbCwgYm9keSwgZGl2LCBoMSwgaDIsIGltZyB7IAogIG1hcmdpbjogMDsgCiAgcGFkZGluZzogMDsgCiAgYm9yZGVyOiAwOyAKICBmb250LXNpemU6IDEwMCU7IAogIGZvbnQ6IGluaGVyaXQ7IAogIHZlcnRpY2FsLWFsaWduOiBiYXNlbGluZTsgCn0KaHRtbCB7IAogIGJhY2tncm91bmQ6ICMxZDFkMWU7CiAgY29sb3I6IHdoaXRlOwogIGZvbnQtZmFtaWx5OiAnSGVsdmV0aWNhIE5ldWUnLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOwp9Ci5wb3N0IHsgCiAgZGlzcGxheTogbm9uZTsgCiAgbGluZS1oZWlnaHQ6IDE7CiAgaGVpZ2h0OiAxMDB2aDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIHBhZGRpbmc6IDhweCA3MHB4IDEzcHggNzBweDsKICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7Cn0KLmhlYWRlciB7IAogIG1hcmdpbi1ib3R0b206IDEwcHg7IAogIHotaW5kZXg6IDE7IAp9Ci5oZWFkZXIgYSB7CiAgZm9udC1zaXplOiAyMHB4OwogIGZvbnQtd2VpZ2h0OiA1MDA7CiAgY29sb3I6IHdoaXRlOwogIHRleHQtZGVjb3JhdGlvbjogbm9uZTsKICAgCn0KLmhlYWRlciBoMSB7CiAgZm9udC1zaXplOiAxNHB4OwogIGZvbnQtd2VpZ2h0OiA0MDA7CiAgb3BhY2l0eTogMC4zOwogIG1hcmdpbi10b3A6IDVweDsgCn0KLmhlYWRlciBoMSBhIHsKICBmb250LXNpemU6IDE0cHg7CiAgZm9udC13ZWlnaHQ6IDQwMDsgCn0KLmhlYWRlciBoMSBhOmhvdmVyIHsKICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTsgCn0KLm1lZGlhLWNvbnRhaW5lciB7CiAgZmxleC1ncm93OiAxOwogIGhlaWdodDogMDsKICB3aWR0aDogMTAwJTsKICB1c2VyLXNlbGVjdDogbm9uZTsgCiAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgCn0KLm1lZGlhIHsKICBtYXgtaGVpZ2h0OiAxMDAlOwogIG1heC13aWR0aDogMTAwJTsKICBkaXNwbGF5OiBibG9jazsKICBtYXJnaW46IGF1dG87CiAgYm9yZGVyLXJhZGl1czogNXB4OwogIG1pbi1oZWlnaHQ6IDUwcHg7IAp9Ci5tZWRpYS1jb250YWluZXIgaW1nIHsKICBiYWNrZ3JvdW5kOiB1cmwoJ2RhdGE6aW1hZ2Uvc3ZnK3htbCw8c3ZnIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDI0IDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGw9IndoaXRlIiBkPSJNMTAuMTQsMS4xNmExMSwxMSwwLDAsMC05LDguOTJBMS41OSwxLjU5LDAsMCwwLDIuNDYsMTIsMS41MiwxLjUyLDAsMCwwLDQuMTEsMTAuN2E4LDgsMCwwLDEsNi42Ni02LjYxQTEuNDIsMS40MiwwLDAsMCwxMiwyLjY5aDBBMS41NywxLjU3LDAsMCwwLDEwLjE0LDEuMTZaIj48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgZnJvbT0iMCAxMiAxMiIgdG89IjM2MCAxMiAxMiIgZHVyPSIwLjc1cyIgcmVwZWF0Q291bnQ9ImluZGVmaW5pdGUiLz48L3BhdGg+PC9zdmc+JykgY2VudGVyIGNlbnRlciBuby1yZXBlYXQ7Cn0KLmFjdGl2ZSB7CiAgZGlzcGxheTogZmxleDsKfQouc3ZnLWJ1dHRvbiB7CiAgb3BhY2l0eTogMC4zOwogIHRyYW5zaXRpb246IDAuMnM7Cn0KLnN2Zy1idXR0b246aG92ZXIgewogIG9wYWNpdHk6IDAuNTsKICBjdXJzb3I6IHBvaW50ZXI7Cn0KLnByZXYtYnV0dG9uLCAubmV4dC1idXR0b24gewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgd2lkdGg6IDcwcHg7CiAgaGVpZ2h0OiAxMDBweDsKICB0b3A6IDUwJTsKICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSk7CiAgYm9yZGVyLXJhZGl1czogMTNweDsKICB6LWluZGV4OiAyOyAKICB1c2VyLXNlbGVjdDogbm9uZTsKICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOwp9Ci5wcmV2LWJ1dHRvbiB7CiAgbGVmdDogMDsKfQoubmV4dC1idXR0b24gewogIHJpZ2h0OiAwOwp9Ci5oaWRkZW4gewogIGRpc3BsYXk6IG5vbmU7IAp9Ci5jb3VudGVyLWNvbnRhaW5lciB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIGJvdHRvbTogOXB4OwogIHJpZ2h0OiAxMXB4OwogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IHJvdzsKICBhbGlnbi1pdGVtczogZW5kOyAKICBwYWRkaW5nOiA1cHg7CiAgYm9yZGVyLXJhZGl1czogMTNweDsKICB6LWluZGV4OiAyOwp9IAouZmV0Y2gtc3Bpbm5lciB7CiAgZmlsbDogd2hpdGU7CiAgb3BhY2l0eTogMC4zOwogIHBhZGRpbmctYm90dG9tOiAxcHg7IAogIG1hcmdpbi1yaWdodDogOHB4OyAKfSAKLmlucHV0LXNwaW5uZXIgewogIGRpc3BsYXk6IG5vbmU7CiAgZmlsbDogd2hpdGU7CiAgYW5pbWF0aW9uOiBzcGlubmVyLWFuaW1hdGlvbiAuNzVzIGluZmluaXRlIGxpbmVhcjsgCn0KLmNvdW50ZXIgewogIGZvbnQtc2l6ZTogMTRweDsKICBvcGFjaXR5OiAwLjM7CiAgbWFyZ2luOiAwOwogIHVzZXItc2VsZWN0OiBub25lOwogIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7CiAgei1pbmRleDogMjsKfQoubnNmdyAubWVkaWEgewogIGZpbHRlcjogYnJpZ2h0bmVzcygyMCUpIGJsdXIoMzVweCk7Cn0KLm5zZncgLm5zZnctYmFubmVyIHsKICBkaXNwbGF5OiBmbGV4Owp9Ci5uc2Z3LWJhbm5lciB7CiAgZGlzcGxheTogbm9uZTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogMDsKICB0b3A6IDA7CiAgd2lkdGg6IDEwMCU7CiAgaGVpZ2h0OiAxMDAlOwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICB6LWluZGV4OiAxOyAKfQoubnNmdy1iYW5uZXIgaDEgewogIG1hcmdpbi1ib3R0b206IDExcHg7IAp9Ci5uc2Z3LWJhbm5lciBidXR0b24gewogIGZvbnQtc2l6ZTogMTJweDsgCn0KLmZldGNoLXNwaW5uZXIgcGF0aCB7CiAgdHJhbnNmb3JtLW9yaWdpbjogY2VudGVyOwogIGFuaW1hdGlvbjogc3Bpbm5lci1hbmltYXRpb24gLjc1cyBpbmZpbml0ZSBsaW5lYXI7IAp9IApAa2V5ZnJhbWVzIHNwaW5uZXItYW5pbWF0aW9uIHsKICAxMDAlIHsKICAgIHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7CiAgfSAgCn0KLmhvbWUgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDEwMCU7CiAgbGVmdDogMDsKICB0b3A6IDA7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHotaW5kZXg6IDEwMDA7CiAgYmFja2dyb3VuZDogcmdiYSgzMCwgMzAsIDMxLCAwLjc1KTsKICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoMzVweCk7CiAgLXdlYmtpdC1iYWNrZHJvcC1maWx0ZXI6IGJsdXIoMzVweCk7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgCn0KLmNsb3NlLWJ1dHRvbiB7CiAgZGlzcGxheTogbm9uZTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgd2lkdGg6IDMycHg7CiAgaGVpZ2h0OiAzMnB4OwogIHBhZGRpbmc6IDEwcHg7CiAgbGVmdDogMTBweDsKICB0b3A6IDRweDsKICB6LWluZGV4OiAyOwp9IAouaG9tZS1lcnJvciB7CiAgZGlzcGxheTogbm9uZTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAxODlweDsKICBwYWRkaW5nOiAxMXB4OwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBtYXJnaW4tdG9wOiAyNXB4OwogIGJhY2tncm91bmQ6ICM2MzFmMWQ7CiAgbWFyZ2luLWJvdHRvbTogMDsgCn0KLmhvbWUtYXJlYSB7CiAgZGlzcGxheTogbm9uZTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgd2lkdGg6IDEwMCU7CiAgaGVpZ2h0OiAxMDAlOyAKfQouaW5wdXQtY29udGFpbmVyIHsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiByb3c7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIG92ZXJmbG93OiBoaWRkZW47CiAgYm9yZGVyOiA0cHggc29saWQgd2hpdGU7CiAgYmFja2dyb3VuZDogd2hpdGU7IAp9Ci5pbnB1dC1jb250YWluZXI6Zm9jdXMtd2l0aGluIHsKICBvdXRsaW5lOiAzcHggc29saWQgcmdiKDMxLCA1NiwgMTE2KTsgCn0KLnN1YnJlZGRpdC1pbnB1dCB7CiAgYm9yZGVyOiBub25lOwogIHdpZHRoOiAyNTBweDsKICBmb250LXNpemU6IDE4cHg7CiAgcGFkZGluZzogMCA3cHg7CiAgb3V0bGluZTogbm9uZTsgCn0KLmlucHV0LWJ1dHRvbiB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGJvcmRlcjogbm9uZTsKICBib3JkZXItcmFkaXVzOiAycHg7CiAgYmFja2dyb3VuZDogd2hpdGU7CiAgd2lkdGg6IDM3cHg7CiAgaGVpZ2h0OiAzN3B4OyAKfQouaW5wdXQtYnV0dG9uOmhvdmVyIHsKICBjdXJzb3I6IHBvaW50ZXI7IAp9Ci5pbnB1dC1hcnJvdyB7CiAgb3BhY2l0eTogMC4zOyAKfQouYmx1ZS1idXR0b24gewogIGJhY2tncm91bmQ6IHJnYig3MiwgMTE5LCAyMzApOyAKfQouYmx1ZS1idXR0b24gc3ZnIHsKICBvcGFjaXR5OiAxOyAKfQouYmx1ZS1idXR0b24gcGF0aCB7CiAgc3Ryb2tlOiB3aGl0ZTsgCn0KLmdpdGh1Yi1pY29uLCAuaG9tZS1idXR0b24gewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICBwYWRkaW5nOiAxMHB4Owp9Ci5naXRodWItaWNvbiB7CiAgd2lkdGg6IDI4cHg7CiAgaGVpZ2h0OiAyOHB4OwogIHRvcDogMTBweDsKICByaWdodDogMTVweDsKICB6LWluZGV4OiAyOwp9Ci5ob21lLWJ1dHRvbiB7CiAgd2lkdGg6IDMxcHg7CiAgaGVpZ2h0OiAzMXB4OwogIHRvcDogNnB4OwogIGxlZnQ6IDEzcHg7CiAgei1pbmRleDogMjsgCiAgYm9yZGVyLXJhZGl1czogMTNweDsKfQouaG9tZS1wb3B1cCB7CiAgZGlzcGxheTogZmxleDsKICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgd2lkdGg6IDM4MHB4OwogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgYm9yZGVyLXJhZGl1czogMTBweDsKICBwYWRkaW5nOiAxNXB4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgei1pbmRleDogMTsgCiAgcGFkZGluZy1ib3R0b206IDU1cHg7Cn0KLnBhc3QtbWVudSB7CiAgbWFyZ2luLXRvcDogMjVweDsgCiAgZm9udC1zaXplOiAxNHB4OyAKICBhcHBlYXJhbmNlOiBtZW51bGlzdC1idXR0b247Cn0KLmxvZ28gewogIG1hcmdpbi1ib3R0b206IDhweDsgCiAgZm9udC1zaXplOiAyMnB4Owp9Ci5kZXNjcmlwdGlvbiB7CiAgbWFyZ2luLWJvdHRvbTogMjVweDsgCiAgb3BhY2l0eTogMC43OwogIGZvbnQtc2l6ZTogMTdweDsKfQpub3NjcmlwdCB7CiAgZGlzcGxheTogZmxleDsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDEwMCU7CiAgYmFja2dyb3VuZDogIzFkMWQxZTsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgei1pbmRleDogMTIzNDU2Owp9Cm5vc2NyaXB0IHNwYW4gewogIG1hcmdpbjogYXV0bzsKfQo8L3N0eWxlPgogICAgPHNjcmlwdD5mdW5jdGlvbiBjcmVhdGVQb3N0KHsKICB0aXRsZSwgCiAgZG9tYWluLCAKICB0aW1lQWdvLCAKICBnYWxsZXJ5Q291bnRlciwgCiAgcmVkZGl0VVJMLCAKICBtZWRpYVVSTCwgCiAgcG9zdGVyVVJMLAogIGlzVmlkZW8sIAogIHZpZGVvSGVpZ2h0LCAKICBvdmVyMTggCn0pIHsKICBsZXQgcG9zdEVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKCiAgcG9zdEVsZW0uaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9InBvc3QgJHtvdmVyMTggPyAnb3ZlcjE4JyA6ICcnfSI+CiAgICA8ZGl2IGNsYXNzPSJoZWFkZXIiPgogICAgICA8YSBocmVmPSIke3JlZGRpdFVSTH0iPiR7dGl0bGV9PC9hPgogICAgICA8aDE+JHt0aW1lQWdvfSAoPGEgaHJlZj0iJHttZWRpYVVSTH0iPiR7ZG9tYWlufTwvYT4ke2dhbGxlcnlDb3VudGVyfSk8L2gxPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJtZWRpYS1jb250YWluZXIiPgogICAgICAke2lzVmlkZW8gCiAgICAgICAgPyBgPHZpZGVvIGRhdGEtc3JjPSIke21lZGlhVVJMfSIgcG9zdGVyPSIke3Bvc3RlclVSTH0iIGhlaWdodD0iJHt2aWRlb0hlaWdodH0iIHByZWxvYWQ9Im5vbmUiIGNsYXNzPSJtZWRpYSIgcGxheXNpbmxpbmUgY29udHJvbHMgbG9vcD5gCiAgICAgICAgOiBgPGltZyBkYXRhLXNyYz0iJHttZWRpYVVSTH0iIGNsYXNzPSJtZWRpYSI+YAogICAgICAgfQogICAgPC9kaXY+CiAgPC9kaXY+YDsKCiAgcmV0dXJuIHBvc3RFbGVtLmZpcnN0Q2hpbGQ7Cn0KCgoKLy8gY29udmVydCBhbiBhcnJheSBvZiBKU09OIHJlZGRpdCBwb3N0IGRhdGEgaW50byBhbiBhcnJheSBvZiBwb3N0IGVsZW1lbnRzCmZ1bmN0aW9uIGNyZWF0ZVBvc3RzKGNoaWxkcmVuKSB7CiAgbGV0IG5ld1Bvc3RzID0gW107CiAgbGV0IG9wZW5Db3VudCA9IDA7CiAgCiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykgewogICAgbGV0IHBvc3REYXRhID0gY2hpbGRyZW5baV0uZGF0YTsKCiAgICAvLyBsb2FkIGNyb3NzcG9zdAogICAgY29uc3QgY3Jvc3Nwb3N0UGFyZW50TGlzdCA9IHBvc3REYXRhLmNyb3NzcG9zdF9wYXJlbnRfbGlzdDsKICAgIGlmIChjcm9zc3Bvc3RQYXJlbnRMaXN0ICYmIGNyb3NzcG9zdFBhcmVudExpc3QubGVuZ3RoID4gMCkgewogICAgICBwb3N0RGF0YSA9IGNyb3NzcG9zdFBhcmVudExpc3RbMF07CiAgICB9CiAgICAKICAgIGNvbnN0IHRpdGxlID0gcG9zdERhdGEudGl0bGU7CiAgICBsZXQgZG9tYWluID0gcG9zdERhdGEuZG9tYWluOwogICAgCiAgICBjb25zdCB0aW1lQWdvID0gdGltZUFnb1N0cihuZXcgRGF0ZSgpIC0gbmV3IERhdGUocG9zdERhdGEuY3JlYXRlZF91dGMgKiAxMDAwKSk7CiAgICAKICAgIGNvbnN0IHJlZGRpdFVSTCA9ICdodHRwczovL29sZC5yZWRkaXQuY29tJyArIHBvc3REYXRhLnBlcm1hbGluazsKICAgIGxldCBtZWRpYVVSTCA9IHBvc3REYXRhLnVybDsKICAgIGxldCBwb3N0ZXJVUkwgPSAnJzsKCiAgICBsZXQgaXNWaWRlbyA9IGZhbHNlOwogICAgbGV0IHZpZGVvSGVpZ2h0ID0gMDsKCiAgICBjb25zdCBvdmVyMTggPSBwb3N0RGF0YS5vdmVyXzE4OwoKICAgIC8vIHJlZGRpdC9pbWd1ciBpbWFnZQogICAgaWYgKGRvbWFpbiA9PT0gJ2kucmVkZC5pdCcgfHwgKGRvbWFpbiA9PT0gJ2kuaW1ndXIuY29tJyAmJiBtZWRpYVVSTC5zbGljZSgtNSkgIT09ICcuZ2lmdicpKSB7CiAgICAgIC8vIG5vdGhpbmcgdG8gZG8gaGVyZQogICAgfQogICAgLy8gcmVkZGl0IGdhbGxlcnkKICAgIGVsc2UgaWYgKGRvbWFpbiA9PT0gJ3JlZGRpdC5jb20nKSB7CiAgICAgIGNvbnN0IGdhbGxlcnlEYXRhID0gcG9zdERhdGEuZ2FsbGVyeV9kYXRhOwogICAgICBpZiAoIWdhbGxlcnlEYXRhIHx8ICFnYWxsZXJ5RGF0YS5pdGVtcykgewogICAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogZ2FsbGVyeSBub3QgZm91bmQsIHNraXBwaW5nICcke3RpdGxlfScgLSAke3JlZGRpdFVSTH1cbmApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBjb25zdCBnYWxsZXJ5SXRlbXMgPSBnYWxsZXJ5RGF0YS5pdGVtczsKICAgICAgY29uc3QgbnVtSXRlbXMgPSBnYWxsZXJ5SXRlbXMubGVuZ3RoOwoKICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBudW1JdGVtczsgaisrKSB7CiAgICAgICAgY29uc3QgaXRlbSA9IGdhbGxlcnlJdGVtc1tqXTsKICAgICAgICBjb25zdCBtZWRpYUlEID0gaXRlbS5tZWRpYV9pZDsKCiAgICAgICAgY29uc3QgbWltZVR5cGUgPSBwb3N0RGF0YS5tZWRpYV9tZXRhZGF0YVttZWRpYUlEXS5tOwogICAgICAgIGlmICghbWltZVR5cGUpIHsKICAgICAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogZ2FsbGVyeSBwb3N0ICR7aisxfS8ke251bUl0ZW1zfTogaW1hZ2Ugbm90IGZvdW5kLCBza2lwcGluZyBpbWFnZSBpbiBnYWxsZXJ5ICcke3RpdGxlfScgLSAke3JlZGRpdFVSTH1cbmApOwogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBleHQgPSBtaW1lVHlwZS5zcGxpdCgnLycpLnBvcCgpOwogICAgICAgIG1lZGlhVVJMID0gYGh0dHBzOi8vaS5yZWRkLml0LyR7bWVkaWFJRH0uJHtleHR9YDsKCiAgICAgICAgY29uc3QgcG9zdEVsZW0gPSBjcmVhdGVQb3N0KHsgCiAgICAgICAgICB0aXRsZTogaXRlbS5jYXB0aW9uID8gYCR7dGl0bGV9OiAke2l0ZW0uY2FwdGlvbn1gIDogdGl0bGUsCiAgICAgICAgICBkb21haW46IGRvbWFpbiwKICAgICAgICAgIHRpbWVBZ286IHRpbWVBZ28sCiAgICAgICAgICByZWRkaXRVUkw6IHJlZGRpdFVSTCwKICAgICAgICAgIG1lZGlhVVJMOiBtZWRpYVVSTCwKICAgICAgICAgIHBvc3RlclVSTDogJycsCiAgICAgICAgICBpc1ZpZGVvOiBmYWxzZSwKICAgICAgICAgIHZpZGVvSGVpZ2h0OiAwLAogICAgICAgICAgZ2FsbGVyeUNvdW50ZXI6IGAsIGltYWdlICR7aisxfS8ke251bUl0ZW1zfWAsCiAgICAgICAgICBvdmVyMTg6IG92ZXIxOAogICAgICAgIH0pOwogICAgICAgIG5ld1Bvc3RzLnB1c2gocG9zdEVsZW0pOwogICAgICB9CiAgICAgIG9wZW5Db3VudCsrOwogICAgICBjb250aW51ZTsKICAgIH0KICAgIC8vIHJlZGRpdCB2aWRlbwogICAgZWxzZSBpZiAoZG9tYWluID09PSAndi5yZWRkLml0JykgewogICAgICBjb25zdCBzZWN1cmVNZWRpYSA9IHBvc3REYXRhLnNlY3VyZV9tZWRpYTsKICAgICAgaWYgKCFzZWN1cmVNZWRpYSB8fCAhc2VjdXJlTWVkaWEucmVkZGl0X3ZpZGVvKSB7CiAgICAgICAgY29uc29sZS53YXJuKGBXYXJuaW5nOiB2aWRlbyBub3QgZm91bmQsIHNraXBwaW5nICcke3RpdGxlfScgLSAke3JlZGRpdFVSTH1cbmApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGNvbnN0IHJlZGRpdFZpZGVvID0gc2VjdXJlTWVkaWEucmVkZGl0X3ZpZGVvOwoKICAgICAgbWVkaWFVUkwgPSByZWRkaXRWaWRlby5obHNfdXJsOwogICAgICBpZiAoIW1lZGlhVVJMKSB7CiAgICAgICAgY29uc29sZS53YXJuKGBXYXJuaW5nOiBITFMgdmlkZW8gVVJMIG5vdCBmb3VuZCwgc2tpcHBpbmcgJyR7dGl0bGV9JyAtICR7cmVkZGl0VVJMfVxuYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmIChwb3N0RGF0YS5wcmV2aWV3ICYmIHBvc3REYXRhLnByZXZpZXcuaW1hZ2VzICYmIHBvc3REYXRhLnByZXZpZXcuaW1hZ2VzWzBdLnNvdXJjZSkgewogICAgICAgIHBvc3RlclVSTCA9IHBvc3REYXRhLnByZXZpZXcuaW1hZ2VzWzBdLnNvdXJjZS51cmw7CiAgICAgIH0KCiAgICAgIG1lZGlhVVJMID0gbWVkaWFVUkwuc3BsaXQoJz8nKVswXTsgICAgICAvLyByZW1vdmUgdHJhY2tpbmcKICAgICAgaXNWaWRlbyA9IHRydWU7CiAgICAgIHZpZGVvSGVpZ2h0ID0gcmVkZGl0VmlkZW8uaGVpZ2h0OwogICAgfQogICAgLy8gdmlkZW8gZmFsbGJhY2sKICAgIC8vIG9wdGlvbmFsIGNoYWluaW5nIHdvdWxkIGJlIGdvb2QgaGVyZSwgYnV0IGJyb3dzZXIgY29tcGF0aWJpbGl0eSBpc24ndCBncmVhdAogICAgZWxzZSBpZiAoCiAgICAgIHBvc3REYXRhLnByZXZpZXcgJiYgCiAgICAgIHBvc3REYXRhLnByZXZpZXcucmVkZGl0X3ZpZGVvX3ByZXZpZXcgJiYgCiAgICAgIHBvc3REYXRhLnByZXZpZXcucmVkZGl0X3ZpZGVvX3ByZXZpZXcuaGxzX3VybAogICAgKSB7CiAgICAgIGNvbnN0IHJlZGRpdFZpZGVvUHJldmlldyA9IHBvc3REYXRhLnByZXZpZXcucmVkZGl0X3ZpZGVvX3ByZXZpZXc7CgogICAgICBtZWRpYVVSTCA9IHJlZGRpdFZpZGVvUHJldmlldy5obHNfdXJsLnNwbGl0KCc/JylbMF07ICAgIC8vIHJlbW92ZSB0cmFja2luZwogICAgICBwb3N0ZXJVUkwgPSBwb3N0RGF0YS5wcmV2aWV3LmltYWdlc1swXS5zb3VyY2UudXJsOwogICAgICBpc1ZpZGVvID0gdHJ1ZTsKICAgICAgdmlkZW9IZWlnaHQgPSByZWRkaXRWaWRlb1ByZXZpZXcuaGVpZ2h0OwogICAgICBkb21haW4gPSBuZXcgVVJMKG1lZGlhVVJMKS5ob3N0bmFtZTsKICAgIH0KICAgIC8vIGltYWdlIGZhbGxiYWNrCiAgICBlbHNlIGlmICgKICAgICAgcG9zdERhdGEucHJldmlldyAmJiAKICAgICAgcG9zdERhdGEucHJldmlldy5pbWFnZXMgJiYgCiAgICAgIHBvc3REYXRhLnByZXZpZXcuaW1hZ2VzWzBdICYmIAogICAgICBwb3N0RGF0YS5wcmV2aWV3LmltYWdlc1swXS5zb3VyY2UgJiYgCiAgICAgIHBvc3REYXRhLnByZXZpZXcuaW1hZ2VzWzBdLnNvdXJjZS51cmwKICAgICkgewogICAgICBtZWRpYVVSTCA9IHBvc3REYXRhLnByZXZpZXcuaW1hZ2VzWzBdLnNvdXJjZS51cmw7CiAgICAgIGRvbWFpbiA9IG5ldyBVUkwobWVkaWFVUkwpLmhvc3RuYW1lOwogICAgfQogICAgZWxzZSB7CiAgICAgIGNvbnNvbGUud2FybihgV2FybmluZzogaW52YWxpZCBkb21haW4gJyR7ZG9tYWlufScsIHNraXBwaW5nICcke3RpdGxlfScgLSAke3JlZGRpdFVSTH1cbmApOwogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBjb25zdCBwb3N0RWxlbSA9IGNyZWF0ZVBvc3QoeyAKICAgICAgdGl0bGU6IHRpdGxlLAogICAgICBkb21haW46IGRvbWFpbiwKICAgICAgdGltZUFnbzogdGltZUFnbywKICAgICAgcmVkZGl0VVJMOiByZWRkaXRVUkwsCiAgICAgIG1lZGlhVVJMOiBtZWRpYVVSTCwKICAgICAgcG9zdGVyVVJMOiBwb3N0ZXJVUkwsCiAgICAgIGlzVmlkZW86IGlzVmlkZW8sCiAgICAgIHZpZGVvSGVpZ2h0OiB2aWRlb0hlaWdodCwKICAgICAgZ2FsbGVyeUNvdW50ZXI6ICcnLAogICAgICBvdmVyMTg6IG92ZXIxOAogICAgfSk7CgogICAgbmV3UG9zdHMucHVzaChwb3N0RWxlbSk7CiAgICBvcGVuQ291bnQrKzsKICB9CiAgY29uc29sZS5sb2coYE9wZW5lZCAke29wZW5Db3VudH0vJHtjaGlsZHJlbi5sZW5ndGh9IHBvc3RzYCk7CgogIHJldHVybiBuZXdQb3N0czsKfQoKCgpmdW5jdGlvbiB0aW1lQWdvU3RyKGRlbHRhKSB7CiAgY29uc3Qgc2Vjb25kcyA9IE1hdGguZmxvb3IoZGVsdGEgLyAxMDAwKTsKCiAgaWYgKHNlY29uZHMgPCA2MCkgewogICAgcmV0dXJuICdqdXN0IG5vdyc7CiAgfQogIGlmIChzZWNvbmRzIDwgMzYwMCkgewogICAgY29uc3QgbWludXRlcyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDYwKTsKICAgIHJldHVybiBtaW51dGVzID4gMSA/IG1pbnV0ZXMgKyAnIG1pbnV0ZXMgYWdvJyA6ICcxIG1pbnV0ZSBhZ28nOwogIH0KICBpZiAoc2Vjb25kcyA8IDg2NDAwKSB7CiAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDM2MDApOwogICAgcmV0dXJuIGhvdXJzID4gMSA/IGhvdXJzICsgJyBob3VycyBhZ28nIDogJzEgaG91ciBhZ28nOwogIH0KCiAgY29uc3QgZGF5cyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDg2NDAwKTsKCiAgaWYgKGRheXMgPCAzMCkgewogICAgcmV0dXJuIGRheXMgPiAxID8gZGF5cyArICcgZGF5cyBhZ28nIDogJzEgZGF5IGFnbyc7CiAgfQogIGlmIChkYXlzIDwgMzYwKSB7CiAgICBjb25zdCBtb250aHMgPSBNYXRoLmZsb29yKGRheXMgLyAzMCk7CiAgICByZXR1cm4gbW9udGhzID4gMSA/IG1vbnRocyArICcgbW9udGhzIGFnbycgOiAnMSBtb250aCBhZ28nOwogIH0KCiAgY29uc3QgeWVhcnMgPSBNYXRoLmZsb29yKGRheXMgLyAzNjUpOwogIHJldHVybiB5ZWFycyA+IDEgPyB5ZWFycyArICcgeWVhcnMgYWdvJyA6ICcxIHllYXIgYWdvJzsKfQoKCgpmdW5jdGlvbiByZW1vdmVQb3N0cygpIHsKICBjb25zdCB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hY3RpdmUgdmlkZW8nKTsKICBpZiAodmlkZW8gIT09IG51bGwpIHsKICAgIHZpZGVvLnBhdXNlKCk7CiAgICB2aWRlby5yZW1vdmVBdHRyaWJ1dGUoJ3NyYycpOwogICAgdmlkZW8ubG9hZCgpOwogIH0KICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9zdCcpLmZvckVhY2gocG9zdCA9PiB7CiAgICBwb3N0LnF1ZXJ5U2VsZWN0b3IoJy5tZWRpYScpLnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7CiAgICBwb3N0LnJlbW92ZSgpOwogIH0pOwp9CgoKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsKICBsZXQgcCA9IDA7ICAgICAgICAgICAgICAvLyBwb3N0IGluZGV4CiAgbGV0IG1heEluZGV4ID0gLTE7ICAgICAgLy8gbWF4IHBvc3QgaW5kZXgKICBsZXQgdHJpZ2dlckluZGV4ID0gMDsgICAvLyBmZXRjaCBuZXcgcG9zdHMgd2hlbiB0aGlzIGluZGV4IGlzIGFjdGl2ZQogIGxldCBhZnRlciA9ICcnOwogIGxldCBuc2Z3ID0gZmFsc2U7CiAgbGV0IHVybCA9ICcnOwoKICBjb25zdCBwcmV2QnV0dG9uICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmV2LWJ1dHRvbicpOwogIGNvbnN0IG5leHRCdXR0b24gID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5leHQtYnV0dG9uJyk7CiAgY29uc3QgY291bnRlckVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY291bnRlcicpOwogIGNvbnN0IGZldGNoU3Bpbm5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mZXRjaC1zcGlubmVyJyk7CgogIGNvbnN0IGhvbWVQYWdlICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhvbWUnKTsKICBjb25zdCBjbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jbG9zZS1idXR0b24nKTsKICBjb25zdCBob21lQXJlYSAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ob21lLWFyZWEnKTsKICBjb25zdCBob21lQnV0dG9uICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ob21lLWJ1dHRvbicpOwogIGNvbnN0IGVycm9yRWxlbSAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhvbWUtZXJyb3InKTsKCiAgY29uc3QgcGFzdE1lbnUgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGFzdC1tZW51Jyk7CiAgY29uc3QgaW5wdXRFbGVtICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VicmVkZGl0LWlucHV0Jyk7CiAgY29uc3QgaW5wdXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtYnV0dG9uJyk7CiAgY29uc3QgaW5wdXRTcGlubmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmlucHV0LXNwaW5uZXInKTsKICBjb25zdCBpbnB1dEFycm93ICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtYXJyb3cnKTsKCiAgLy8gY2hlY2sgaWYgSExTIHZpZGVvcyBhcmUgc3VwcG9ydGVkCiAgaWYgKCFkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpLmNhblBsYXlUeXBlKCdhcHBsaWNhdGlvbi92bmQuYXBwbGUubXBlZ1VSTCcpKSB7CiAgICBlcnJvckVsZW0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICBlcnJvckVsZW0uaW5uZXJIVE1MID0gJ0Vycm9yOiBUaGlzIGJyb3dzZXIgaXMgbm90IG9mZmljaWFsbHkgc3VwcG9ydGVkLiBQbGVhc2UgdXNlIFNhZmFyaSBpbnN0ZWFkLic7CiAgfQoKCiAgZnVuY3Rpb24gbG9hZFBvc3QoaSkgewogICAgY29uc3QgcG9zdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9zdCcpOwoKICAgIGlmIChpIDwgMCB8fCBpID49IHBvc3RzLmxlbmd0aCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gZmV0Y2ggbmV3IHBvc3RzIG9uIHRyaWdnZXIKICAgIGlmIChpID09PSB0cmlnZ2VySW5kZXggJiYgYWZ0ZXIgIT09IG51bGwpIHsKICAgICAgICBmZXRjaFNwaW5uZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICAgICAgZmV0Y2godXJsICsgJyZhZnRlcj0nICsgYWZ0ZXIpCiAgICAgICAgICAudGhlbihyZXNwID0+IHJlc3Aub2sgPyByZXNwLmpzb24oKSA6IG51bGwpCiAgICAgICAgICAudGhlbihqc29uID0+IHsKICAgICAgICAgICAgICBpZiAoanNvbiA9PT0gbnVsbCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb25zdCBuZXh0UG9zdHMgPSBjcmVhdGVQb3N0cyhqc29uWydkYXRhJ11bJ2NoaWxkcmVuJ10pOwogICAgICAgICAgICAgIGlmIChuZXh0UG9zdHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICAvLyBubyBpbWFnZXMvdmlkZW9zIGZvdW5kLCBzdG9wIGhlcmUKICAgICAgICAgICAgICAgIGFmdGVyID0gbnVsbDsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmQoLi4ubmV4dFBvc3RzKTsKCiAgICAgICAgICAgICAgYWZ0ZXIgPSBqc29uWydkYXRhJ11bJ2FmdGVyJ107CiAgICAgICAgICAgICAgdHJpZ2dlckluZGV4ID0gcG9zdHMubGVuZ3RoICsgTWF0aC5tYXgoMCwgbmV4dFBvc3RzLmxlbmd0aCAtIDUpOwoKICAgICAgICAgICAgICBuZXh0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgICAgICAgICAgIGNvdW50ZXJFbGVtLnRleHRDb250ZW50ID0gcCsxICsgJy8nICsgKHBvc3RzLmxlbmd0aCArIG5leHRQb3N0cy5sZW5ndGgpOwogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5lcnJvcihlcnIpKQogICAgICAgICAgLmZpbmFsbHkoKCkgPT4gZmV0Y2hTcGlubmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpKTsKICAgIH0KCiAgICAvLyByZW1vdmUgY3VycmVudCB2aWRlbyBmcm9tIG1lbW9yeQogICAgY29uc3QgdmlkZW8gPSBwb3N0c1twXS5xdWVyeVNlbGVjdG9yKCd2aWRlbycpOwogICAgaWYgKHZpZGVvICE9PSBudWxsKSB7CiAgICAgIHZpZGVvLnBhdXNlKCk7CiAgICAgIHZpZGVvLnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7CiAgICAgIHZpZGVvLmxvYWQoKTsKICAgICAgdmlkZW8ucmVtb3ZlQXR0cmlidXRlKCd3aWR0aCcpOwogICAgfQoKICAgIHBvc3RzW3BdLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgcCA9IGk7CiAgICBwb3N0c1twXS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKCiAgICBpZiAoIW5zZncpIHsKICAgICAgaWYgKHBvc3RzW3BdLmNsYXNzTGlzdC5jb250YWlucygnb3ZlcjE4JykpIHsKICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ25zZncnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ25zZncnKTsKICAgICAgfQogICAgfQoKICAgIC8vIGxvYWQgbmV4dCBtZWRpYQogICAgY29uc3QgbWVkaWEgPSBwb3N0c1twXS5xdWVyeVNlbGVjdG9yKCcubWVkaWEnKTsKICAgIG1lZGlhLnNyYyA9IG1lZGlhLmdldEF0dHJpYnV0ZSgnZGF0YS1zcmMnKTsKCiAgICBpZiAobWVkaWEubG9jYWxOYW1lID09PSAndmlkZW8nKSB7CiAgICAgIC8vIHN0b3AgdmlkZW8gY29udHJvbHMgZnJvbSBnbGl0Y2hpbmcgCiAgICAgIG1lZGlhLndpZHRoID0gbWVkaWEuY2xpZW50V2lkdGg7CiAgICB9CgogICAgLy8gcHJlbG9hZCBwb3N0cwogICAgaWYgKHAgPiBtYXhJbmRleCkgewogICAgICBtYXhJbmRleCA9IHA7CgogICAgICBmb3IgKGxldCBqID0gcCsxOyBqIDwgTWF0aC5taW4ocG9zdHMubGVuZ3RoLCBwKzUpOyBqKyspIHsKICAgICAgICBjb25zdCBtZWRpYSA9IHBvc3RzW2pdLnF1ZXJ5U2VsZWN0b3IoJy5tZWRpYScpOwogICAgICAgIG1lZGlhLnNyYyA9IG1lZGlhLmdldEF0dHJpYnV0ZSgnZGF0YS1zcmMnKTsKICAgICAgfQogICAgfQoKICAgIHByZXZCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7CiAgICBuZXh0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwoKICAgIGlmIChwID09PSAwKSB7CiAgICAgIHByZXZCdXR0b24uY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICB9CiAgICBpZiAocCA9PT0gcG9zdHMubGVuZ3RoLTEpIHsKICAgICAgbmV4dEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTsKICAgIH0KCiAgICBjb3VudGVyRWxlbS50ZXh0Q29udGVudCA9IHArMSArICcvJyArIHBvc3RzLmxlbmd0aDsKICB9CgoKCiAgZnVuY3Rpb24gcHJldlBvc3QoKSB7IGxvYWRQb3N0KHAtMSkgfQogIGZ1bmN0aW9uIG5leHRQb3N0KCkgeyBsb2FkUG9zdChwKzEpIH0KCgoKICBmdW5jdGlvbiBzZWFyY2goKSB7CiAgICBjb25zdCBwYXR0ZXJuID0gL15bYS16QS1aMC05XVthLXpBLVowLTlfXXsyLDIwfSQvOwogICAgbGV0IGlucHV0ID0gaW5wdXRFbGVtLnZhbHVlLnRyaW0oKTsKICAgIGlucHV0RWxlbS5ibHVyKCk7CgogICAgaWYgKGlucHV0Lmxlbmd0aCA9PT0gMCkgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoIXBhdHRlcm4udGVzdChpbnB1dCkpIHsKICAgICAgZXJyb3JFbGVtLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogICAgICBlcnJvckVsZW0uaW5uZXJIVE1MID0gJ0Vycm9yOiBJbnZhbGlkIHN1YnJlZGRpdCBuYW1lLic7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpbnB1dFNwaW5uZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICBpbnB1dEFycm93LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CgogICAgY29uc3QgaW5pdFVSTCA9IGBodHRwczovL2FwaS5yZWRkaXQuY29tL3IvJHtpbnB1dH0vdG9wLmpzb24/dD0ke3Bhc3RNZW51LnZhbHVlfSZsaW1pdD0yNWA7CgogICAgZmV0Y2goaW5pdFVSTCkKICAgICAgLnRoZW4ocmVzcCA9PiByZXNwLm9rID8gcmVzcC5qc29uKCkgOiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoKSkpCiAgICAgIC50aGVuKGpzb24gPT4gewogICAgICAgIGNvbnN0IHBvc3RzID0gY3JlYXRlUG9zdHMoanNvblsnZGF0YSddWydjaGlsZHJlbiddKTsKICAgICAgICBpZiAocG9zdHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTsKICAgICAgICB9CgogICAgICAgIHJlbW92ZVBvc3RzKCk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmQoLi4ucG9zdHMpOwoKICAgICAgICAvLyByZXNldCBzdGF0ZQogICAgICAgIHAgPSAwOwogICAgICAgIG1heEluZGV4ID0gLTE7CiAgICAgICAgdHJpZ2dlckluZGV4ID0gTWF0aC5tYXgoMCwgcG9zdHMubGVuZ3RoIC0gNSk7CiAgICAgICAgYWZ0ZXIgPSBqc29uWydkYXRhJ11bJ2FmdGVyJ107CiAgICAgICAgdXJsID0gaW5pdFVSTDsKCiAgICAgICAgaG9tZVBhZ2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBjbG9zZUJ1dHRvbi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICBob21lQXJlYS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAgICAgICBlcnJvckVsZW0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKCiAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBgcnRvcCAke2lucHV0fSAke3Bhc3RNZW51LnZhbHVlICE9PSAnYWxsJyA/ICdwYXN0ICcgKyBwYXN0TWVudS52YWx1ZSA6ICdhbGwtdGltZSd9YDsKCiAgICAgICAgbG9hZFBvc3QoMCk7CiAgICAgIH0pCiAgICAgIC5jYXRjaChfID0+IHsKICAgICAgICBlcnJvckVsZW0uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgaWYgKCFuYXZpZ2F0b3Iub25MaW5lKSB7CiAgICAgICAgICBlcnJvckVsZW0uaW5uZXJIVE1MID0gJ0Vycm9yOiBZb3VyIGludGVybmV0IGNvbm5lY3Rpb24gYXBwZWFycyB0byBiZSBvZmZsaW5lLiBQbGVhc2UgcmVjb25uZWN0IGFuZCB0cnkgYWdhaW4uJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZXJyb3JFbGVtLmlubmVySFRNTCA9ICdFcnJvcjogVW5hYmxlIHRvIGxvYWQgc3VicmVkZGl0IGRhdGEuIFBsZWFzZSB0cnkgYWdhaW4gb3IgdHJ5IGEgZGlmZmVyZW50IHN1YnJlZGRpdC4nOwogICAgICAgIH0KICAgICAgfSkKICAgICAgLmZpbmFsbHkoKCkgPT4gewogICAgICAgIGlucHV0U3Bpbm5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGlucHV0QXJyb3cuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgIH0pOwogIH0KCiAgLy8gRXZlbnQgbGlzdGVuZXJzCgogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHsKICAgIGlmIChob21lUGFnZS5zdHlsZS5kaXNwbGF5ID09PSAnbm9uZScpIHsKICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMzcpIHsKICAgICAgICBwcmV2UG9zdCgpOwogICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMzkpIHsgCiAgICAgICAgbmV4dFBvc3QoKTsKICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT09IDMyICYmICFkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygnbnNmdycpKSB7CiAgICAgICAgY29uc3QgdmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWN0aXZlIHZpZGVvJyk7CiAgICAgICAgaWYgKHZpZGVvICE9PSBudWxsKSB7CiAgICAgICAgICB2aWRlby5wYXVzZWQgPyB2aWRlby5wbGF5KCkgOiB2aWRlby5wYXVzZSgpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOwoKICBwcmV2QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcHJldlBvc3QpOwogIG5leHRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBuZXh0UG9zdCk7CgogIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gaG9tZVBhZ2Uuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7CiAgaG9tZUFyZWEuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBob21lUGFnZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnKTsKICBob21lQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gaG9tZVBhZ2Uuc3R5bGUuZGlzcGxheSA9ICdmbGV4Jyk7CgogIGlucHV0RWxlbS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChlKSA9PiB7CiAgICBpZiAoZS50YXJnZXQudmFsdWUubGVuZ3RoID4gMCkgewogICAgICBpbnB1dEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdibHVlLWJ1dHRvbicpOwogICAgfSBlbHNlIHsKICAgICAgaW5wdXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnYmx1ZS1idXR0b24nKTsKICAgIH0KICB9KTsKCiAgaW5wdXRFbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4geyBpZiAoZS5rZXlDb2RlID09PSAxMykgc2VhcmNoKCkgfSk7CiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmlucHV0LWJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2VhcmNoKTsKCiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5zZnctYmFubmVyIGJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCduc2Z3Jyk7CiAgICBuc2Z3ID0gdHJ1ZTsKICB9KTsKfSk7Cjwvc2NyaXB0PgogIDwvaGVhZD4KICA8Ym9keT4KICAgIDxub3NjcmlwdD4KICAgICAgPHNwYW4+UGxlYXNlIGVuYWJsZSBKYXZhU2NyaXB0IHRvIHVzZSB0aGlzIHdlYnNpdGUuPC9zcGFuPgogICAgPC9ub3NjcmlwdD4KICAgIDxkaXYgY2xhc3M9ImhvbWUiPgogICAgICA8c3ZnIGNsYXNzPSJjbG9zZS1idXR0b24gc3ZnLWJ1dHRvbiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj4KICAgICAgICA8cGF0aCBkPSJNMTggNkw2IDE4TTYgNmwxMiAxMiI+PC9wYXRoPgogICAgICA8L3N2Zz4KICAgICAgPGEgaHJlZj0iaHR0cHM6Ly9naXRodWIuY29tL25pY2tyai9ydG9wIj4KICAgICAgICA8c3ZnIHJvbGU9ImltZyIgY2xhc3M9ImdpdGh1Yi1pY29uIHN2Zy1idXR0b24iIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgICAgICAgIDxwYXRoIGZpbGw9IndoaXRlIiBkPSJNMTIgLjI5N2MtNi42MyAwLTEyIDUuMzczLTEyIDEyIDAgNS4zMDMgMy40MzggOS44IDguMjA1IDExLjM4NS42LjExMy44Mi0uMjU4LjgyLS41NzcgMC0uMjg1LS4wMS0xLjA0LS4wMTUtMi4wNC0zLjMzOC43MjQtNC4wNDItMS42MS00LjA0Mi0xLjYxQzQuNDIyIDE4LjA3IDMuNjMzIDE3LjcgMy42MzMgMTcuN2MtMS4wODctLjc0NC4wODQtLjcyOS4wODQtLjcyOSAxLjIwNS4wODQgMS44MzggMS4yMzYgMS44MzggMS4yMzYgMS4wNyAxLjgzNSAyLjgwOSAxLjMwNSAzLjQ5NS45OTguMTA4LS43NzYuNDE3LTEuMzA1Ljc2LTEuNjA1LTIuNjY1LS4zLTUuNDY2LTEuMzMyLTUuNDY2LTUuOTMgMC0xLjMxLjQ2NS0yLjM4IDEuMjM1LTMuMjItLjEzNS0uMzAzLS41NC0xLjUyMy4xMDUtMy4xNzYgMCAwIDEuMDA1LS4zMjIgMy4zIDEuMjMuOTYtLjI2NyAxLjk4LS4zOTkgMy0uNDA1IDEuMDIuMDA2IDIuMDQuMTM4IDMgLjQwNSAyLjI4LTEuNTUyIDMuMjg1LTEuMjMgMy4yODUtMS4yMy42NDUgMS42NTMuMjQgMi44NzMuMTIgMy4xNzYuNzY1Ljg0IDEuMjMgMS45MSAxLjIzIDMuMjIgMCA0LjYxLTIuODA1IDUuNjI1LTUuNDc1IDUuOTIuNDIuMzYuODEgMS4wOTYuODEgMi4yMiAwIDEuNjA2LS4wMTUgMi44OTYtLjAxNSAzLjI4NiAwIC4zMTUuMjEuNjkuODI1LjU3QzIwLjU2NSAyMi4wOTIgMjQgMTcuNTkyIDI0IDEyLjI5N2MwLTYuNjI3LTUuMzczLTEyLTEyLTEyIi8+CiAgICAgICAgPC9zdmc+CiAgICAgIDwvYT4KICAgICAgPGRpdiBjbGFzcz0iaG9tZS1wb3B1cCI+CiAgICAgICAgPGgxIGNsYXNzPSJsb2dvIj5ydG9wPC9oMT4KICAgICAgICA8aDIgY2xhc3M9ImRlc2NyaXB0aW9uIj5Ccm93c2UgdGhlIHRvcCBpbWFnZXMgJiB2aWRlb3Mgb24gYW55IHN1YnJlZGRpdDwvaDI+CiAgICAgICAgPGRpdiBjbGFzcz0iaW5wdXQtY29udGFpbmVyIj4KICAgICAgICAgIDxpbnB1dCBjbGFzcz0ic3VicmVkZGl0LWlucHV0IiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0ic3VicmVkZGl0IiBhdXRvZm9jdXM9IiI+CiAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJpbnB1dC1idXR0b24iPgogICAgICAgICAgICA8c3ZnIGNsYXNzPSJpbnB1dC1zcGlubmVyIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgICAgICAgICAgICA8cGF0aCBkPSJNMTAuMTQsMS4xNmExMSwxMSwwLDAsMC05LDguOTJBMS41OSwxLjU5LDAsMCwwLDIuNDYsMTIsMS41MiwxLjUyLDAsMCwwLDQuMTEsMTAuN2E4LDgsMCwwLDEsNi42Ni02LjYxQTEuNDIsMS40MiwwLDAsMCwxMiwyLjY5aDBBMS41NywxLjU3LDAsMCwwLDEwLjE0LDEuMTZaIj48L3BhdGg+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgICA8c3ZnIGNsYXNzPSJpbnB1dC1hcnJvdyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCA1MCA1MCI+ICAgCiAgICAgICAgICAgICAgPHBhdGggZD0iTTE1LDEwIEwzNSwyNSBMMTUsNDAiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iNCIgZmlsbD0ibm9uZSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48L3BhdGg+CiAgICAgICAgICAgIDwvc3ZnPgogICAgICAgICAgPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPHNlbGVjdCBjbGFzcz0icGFzdC1tZW51IiBuYW1lPSJtZW51Ij4KICAgICAgICAgIDxvcHRpb24gdmFsdWU9ImhvdXIiPnBhc3QgaG91cjwvb3B0aW9uPgogICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iZGF5IiBzZWxlY3RlZD5wYXN0IGRheTwvb3B0aW9uPgogICAgICAgICAgPG9wdGlvbiB2YWx1ZT0id2VlayI+cGFzdCB3ZWVrPC9vcHRpb24+CiAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJtb250aCI+cGFzdCBtb250aDwvb3B0aW9uPgogICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ieWVhciI+cGFzdCB5ZWFyPC9vcHRpb24+CiAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJhbGwiPmFsbC10aW1lPC9vcHRpb24+CiAgICAgICAgPC9zZWxlY3Q+CiAgICAgICAgPHAgY2xhc3M9ImhvbWUtZXJyb3IiPjwvcD4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9ImhvbWUtYXJlYSI+PC9kaXY+CiAgICA8L2Rpdj4KICAgIDxzdmcgY2xhc3M9ImhvbWUtYnV0dG9uIHN2Zy1idXR0b24iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPgogICAgICA8cGF0aCBkPSJNMyAxMmgxOE0zIDZoMThNMyAxOGgxOCI+PC9wYXRoPiAKICAgIDwvc3ZnPgogICAgPGRpdiBjbGFzcz0ibnNmdy1iYW5uZXIiPgogICAgICA8aDE+V2FybmluZzogdGhpcyBwb3N0IGlzIE5TRlc8L2gxPgogICAgICA8YnV0dG9uPkknbSBvdmVyIDE4PC9idXR0b24+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9InByZXYtYnV0dG9uIGhpZGRlbiBzdmctYnV0dG9uIj4KICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCAxMCAxNSI+CiAgICAgICAgPHBhdGggZD0iTTcgMWwtNiA2IDYgNiIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbGluZWNhcD0icm91bmQiPjwvcGF0aD4KICAgICAgPC9zdmc+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9Im5leHQtYnV0dG9uIGhpZGRlbiBzdmctYnV0dG9uIj4KICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCAxMSAxNSI+CiAgICAgICAgPHBhdGggZD0iTTMgMWw2IDYtNiA2IiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PC9wYXRoPgogICAgICA8L3N2Zz4KICAgIDwvZGl2PgogICAgPGRpdiBjbGFzcz0iY291bnRlci1jb250YWluZXIiPgogICAgICA8c3ZnIGNsYXNzPSJmZXRjaC1zcGlubmVyIGhpZGRlbiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICAgICAgPHBhdGggZD0iTTEwLjE0LDEuMTZhMTEsMTEsMCwwLDAtOSw4LjkyQTEuNTksMS41OSwwLDAsMCwyLjQ2LDEyLDEuNTIsMS41MiwwLDAsMCw0LjExLDEwLjdhOCw4LDAsMCwxLDYuNjYtNi42MUExLjQyLDEuNDIsMCwwLDAsMTIsMi42OWgwQTEuNTcsMS41NywwLDAsMCwxMC4xNCwxLjE2WiI+PC9wYXRoPgogICAgICA8L3N2Zz4KICAgICAgPHAgY2xhc3M9ImNvdW50ZXIiPjwvcD4KICAgIDwvZGl2PgogIDwvYm9keT4KPC9odG1sPgo=